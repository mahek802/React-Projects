!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("chart.js")):"function"==typeof define&&define.amd?define(["exports","chart.js"],e):e(t.lineHeightAnnotationPlugin={},t.Chart)}(this,function(t,e){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function r(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],o=!0,i=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){i=!0,r=t}finally{try{o||null==s.return||s.return()}finally{if(i)throw r}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}e=e&&e.hasOwnProperty("default")?e.default:e;var s=function(){function t(e,n){o(this,t),this.ctx=e,this.options=n}return r(t,[{key:"shadow",value:function(){var t=this.options;if(t.shadow){var e=this.ctx,n=t.shadow,o=e.stroke;e.stroke=function(){e.save(),e.shadowColor=n.color?n.color:"rgba(0,0,0,0.35)",e.shadowBlur=n.blur?n.blur:10,e.shadowOffsetX=n.offset?n.offset.x:0,e.shadowOffsetY=n.offset?n.offset.y:3,o.apply(this,arguments),e.restore()}}}},{key:"drawLineHeightAnnotation",value:function(t,e,n){var o=this.ctx,i=this.options;o.save(),o.beginPath(),i.noDash||o.setLineDash([10,10]),o.moveTo(t,n),o.lineTo(t,e),o.lineWidth=i.lineWeight?i.lineWeight:1.5,o.strokeStyle=i.color?i.color:"#000",o.stroke(),o.restore()}}]),t}(),u=function(){function t(e){o(this,t),this.chart=e}return r(t,[{key:"calculateHighestDataY",value:function(t){var e=a(t,6),n=e[0],o=e[1],i=e[2],r=e[3],s=e[4];return n-n*(i-s)/(r-s)+2*e[5]+o-9}},{key:"isTooltipActive",value:function(){return this.tooltip._active&&this.tooltip._active.length}},{key:"isPointTooHigh",value:function(t,e,n){return t>e&&(t=e-n),t}},{key:"getPointFromDataset",value:function(t,e){return t.data[e._index].y?t.data[e._index].y:t.data[e._index]}},{key:"getPointMetrics",value:function(t,e,n){var o=a(n,2),i=o[0],r=o[1];return e>i&&(i=t.borderWidth?e-(r=t.borderWidth):e),[i,r]}},{key:"getMaximumDimensions",value:function(t){if(t.ticksAsNumbers)return[t.ticksAsNumbers[0],t.ticksAsNumbers[t.ticksAsNumbers.length-1],t.top,t.bottom];var e=Number(t.ticks[0]);return[Number(t.ticks[t.ticks.length-1]),e,t.top,t.bottom]}},{key:"options",get:function(){return!!this.chart.options.lineHeightAnnotation&&this.chart.options.lineHeightAnnotation}},{key:"tooltip",get:function(){return this.chart.tooltip}},{key:"datasets",get:function(){return this.chart.config.data.datasets}},{key:"ticks",get:function(){return this.chart.scales["x-axis-0"].ticks}},{key:"chartArea",get:function(){return this.chart.chartArea}}]),t}(),c={id:"lineHeightAnnotation",afterDatasetDraw:function(t){var e=new u(t),n=e.options,o=t.ctx,i=new s(o,n);i.shadow();var r=t.scales[n.xAxis?n.xAxis:"x-axis-0"],c=t.scales[n.yAxis?n.yAxis:"y-axis-0"];if(c&&r){var f=a(e.getMaximumDimensions(c),4),l=f[0],h=f[1],d=f[2],y=f[3],p=e.datasets,v=[];if(void 0===n.always||n.always){p.forEach(function(e,n){v.push(t.getDatasetMeta(n).data)});for(var g=e.ticks,m=function(t){var e=r.getPixelForTick(t);v.map(function(t){t.filter(function(t){return t._model.x===e}).forEach(function(t){i.drawLineHeightAnnotation(e,y,t._model.y)})})},b=0;b<g.length;b++)m(b)}if((n.hover||!1)&&e.isTooltipActive()){var k=e.tooltip._active[0],x=k.tooltipPosition().x,w=1,A=0;p.forEach(function(t){var n=e.getPointFromDataset(t,k),o=a(e.getPointMetrics(t,n,[w,A]),2);w=o[0],A=o[1]});var P=e.calculateHighestDataY([y,d,w,l,h,A]);e.isPointTooHigh(P,y,h),i.drawLineHeightAnnotation(x,y,P)}}}};"function"==typeof define&&define.amd||"object"===("undefined"==typeof module?"undefined":n(module))&&module.exports||e.pluginService.register(c),t.AnnotationRenderer=s,t.LineChartUtils=u,t.default=c,Object.defineProperty(t,"__esModule",{value:!0})});